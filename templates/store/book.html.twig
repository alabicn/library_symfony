{% extends 'base.html.twig' %}

{% block title %}Hello BookController!{% endblock %}

{% block body %}
<style>
    .example-wrapper {
        margin: 1em auto;
        max-width: 800px;
        width: 95%;
        font: 18px/1.5 sans-serif;
    }

    .example-wrapper code {
        background: #F5F5F5;
        padding: 2px 6px;
    }
</style>


<div>
    <h1>{{ book.author.name ~ " " ~ book.author.surname|upper}}</h1>
    <h3>{{ book.title }}</h3>
    <img src="/assets/img/{{ book.srcImage }}" alt="{{ book.altImage }}" title="{{ book.titleImage }}" />

    <h1>{% for e in book.editions %}
        {{ e.name }} : {{ book.prices[e.id]|number_format(2, '.', ' ') }} â‚¬<br />
        {% endfor %}
    </h1>

    <a href={{ path("shopping_cart", {'id': book.id})}}>Add to cart?</a>
   
    <div class="example-wrapper">


        {% if app.user and book.ratedByUser(app.user.id) == false %}

        {{ form_start(evaluationForm) }}
        {{ form_row(evaluationForm.rating, {'attr': {'placeholder': 'Your rating?'}}) }}
        {{ form_row(evaluationForm.comment, {'attr': {'placeholder': 'Your comment...'}}) }}
        {{ form_end(evaluationForm) }}


        {% endif %}

    







        <h2>{{ book.evaluations | length }} messages</h2>


        <p>

            Average rating :
            {% if book.average %}
            {{ book.average }}/5
            {% else %}
            No ratings yet.
            {% endif %}
        </p>


        {% for evaluation in book.evaluations %}

        <ul>
            <li><strong>{{ evaluation.comment}}<br></strong>
                <span><a href={{ path("show_user", {'id': evaluation.user.id}) }}>{{ evaluation.user.uname }}</a>
                    answered : {{ evaluation.dateEvaluation|date("F jS\\, Y \\a\\t G:i\\h", "Europe/Paris") }}</span>
                <span>{{ evaluation.user.uname }} rated : {{ evaluation.rating }}/5</span>
                </li>
                {% if is_granted('ROLE_ADMIN') %}
                <li><a href={{path("remove_evaluation", {'id': evaluation.id})}} onclick="return confirm('Are you sure?')">DELETE?</a></li>
                {% endif %}




        </ul>
        {% endfor %}

    </div>





</div>

{% endblock %}